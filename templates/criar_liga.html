<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Create League - Fantasy Champ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/daisyui@1.19.0/dist/full.js"></script>
</head>

<body class="bg-gray-100 min-h-screen" data-theme="corporate">

<div class="container mx-auto p-6 max-w-2xl">

    <!-- HEADER -->
    <div class="text-center mb-10">
        <h1 class="text-4xl font-bold text-primary mb-2">Create New League</h1>
        <p class="text-gray-600">Create your own league and challenge other players!</p>
    </div>

    <!-- FORM -->
    <div class="card bg-white shadow-xl rounded-xl border border-gray-200">
        <div class="card-body">

            <form method="POST" class="space-y-6" style="margin: 10px;">

                <!-- League Name -->
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-semibold">League Name</span>
                    </label>
                    <input type="text" name="nome"
                        class="input input-bordered input-primary bg-white border-2"
                        required>
                </div>

                <!-- Dates -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-semibold">Start Date</span>
                        </label>
                        <input type="date" name="data_inicio" class="input input-bordered" required>
                    </div>

                    <div class="form-control">
                        <label class="label">
                            <span class="label-text font-semibold">End Date</span>
                        </label>
                        <input type="date" name="data_fim" class="input input-bordered" required>
                    </div>
                </div>

                <!-- League Type -->
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-semibold">League Type</span>
                    </label>
                    <select name="tipo_liga" class="select select-bordered" required>
                        <option value="" disabled selected>Select league type</option>
                        {% for tipo in tipos_liga %}
                        <option value="{{ tipo.id }}">{{ tipo.tipo }}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Invite Code -->
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-semibold">Invite Code (Optional)</span>
                    </label>

                    <input type="text" name="codigo_convite"
                        class="input input-bordered input-primary bg-white border-2"
                        maxlength="10"
                        placeholder="Code">
                </div>

                <!-- BUTTONS -->
                <div class="flex justify-between pt-4">
                    <a href="/ligas"
                    class="btn bg-red-600 hover:bg-red-700 text-white border-none rounded-full px-6">
                        ← Cancel
                    </a>

                    <button type="submit"
                        class="btn bg-green-600 hover:bg-green-700 text-white border-none rounded-full px-6">
                        Create League
                    </button>
                </div>


            </form>

        </div>
    </div>

    <!-- INFO BOX -->
    <div class="mt-8 bg-blue-50 p-5 rounded-lg shadow border border-blue-100">
        <h3 class="font-bold text-blue-800 mb-2">League Type Information</h3>
        <ul class="text-sm text-blue-700 list-disc list-inside space-y-1">
            <li><strong>Public:</strong> Anyone can view and join.</li>
            <li><strong>Private:</strong> Only players with an invite code can join.</li>
        </ul>
    </div>

</div>

<script>
// Date validation
document.addEventListener('DOMContentLoaded', function() {
    const today = new Date().toISOString().split('T')[0];
    const startInput = document.querySelector('input[name="data_inicio"]');
    const endInput = document.querySelector('input[name="data_fim"]');

    startInput.min = today;

    startInput.addEventListener('change', function() {
        endInput.min = this.value;
    });

    // League type logic
    const typeSelect = document.querySelector('select[name="tipo_liga"]');
    const codeInput = document.querySelector('input[name="codigo_convite"]');

    typeSelect.addEventListener('change', function () {
        const type = this.value;

        if (type === "LT02" || type === "2") {
            // private league → code required
            codeInput.required = true;
            codeInput.placeholder = "Required for private leagues";
            codeInput.classList.add("input-warning");
        } else {
            // public league → code optional
            codeInput.required = false;
            codeInput.placeholder = "Leave empty to auto-generate";
            codeInput.classList.remove("input-warning");
        }
    });

    // Final validation
    document.querySelector("form").addEventListener("submit", function (e) {
        const type = typeSelect.value;

        if ((type === "LT02" || type === "2") && codeInput.value.trim() === "") {
            e.preventDefault();
            alert("To create a private league, you must enter an invite code.");
        }
    });
});
</script>

</body>
</html>
